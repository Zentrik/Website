---
title: 'An Explainer: Convex Programming Approach to Powered Descent Guidance for
  Mars Landing'
summary: An explanation of a paper on solving the guidance problem for pinpoint landing
  with rockets.
date: '2021-06-11T18:13:10.351Z'
categories: []
author: admin
lastMod: '2021-06-11T18:13:10.351Z'
featured: no
draft: no
image:
  caption: ''
  focal_point: ''
projects: []
tags: []
output:
  blogdown::html_page:
    toc: true
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>

<div id="TOC">
<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#notation">Notation</a></li>
<li><a href="#problem-formulation">Problem Formulation</a>
<ul>
<li><a href="#problem-1">Problem 1</a></li>
</ul></li>
<li><a href="#convexification-of-the-control-magnitude-constraint">Convexification of the Control Magnitude Constraint</a>
<ul>
<li><a href="#problem-2">Problem 2</a></li>
</ul></li>
</ul>
</div>

<div id="summary" class="section level1">
<h1>Summary</h1>
<p>The paper tries to solve the problem of ‘guiding a lander spacecraft to a given target on the planet’s surface with an accuracy of a fewer than several hundred meters’ by ‘finding the fuel optimal trajectory that takes a lander with a given initial state (position and velocity) to a prescribed final state’. The lander is modelled ‘as a point mass with a single thruster’ ‘in a uniform gravity field’, with decreasing mass and thrusters that can be gimballed and throttled subject to constraints. As ‘mars pinpoint landing requires real-time onboard computation of the optimal trajectory’ the optimisation problem needs to be convex however, the thrust magnitude constraint is a nonconvex constraint. To convexify this problem ‘a slack variable is introduced to relax the nonconvex constraint’ and ‘it is shown that any optimal solution for the resulting relaxed problem is also optimal for the original problem’. ‘Then we approximate the relaxed optimal control problem as a finite-dimensional parameter optimization problem via representing the control input by a finite set of basis functions, which leads to a finite-dimensional convex parameter optimization problem; more specifically it leads to a SOCP. Additionally, we consider thruster pointing constraints and extend our convex solution approach to handle this constraint via a heuristic. Finally, we present some simulation results for an example spacecraft’.</p>
</div>
<div id="notation" class="section level1">
<h1>Notation</h1>
<p><span class="math inline">\(x \in [a, b]\)</span> — <span class="math inline">\(x\)</span> is in the range <span class="math inline">\(a\)</span> to <span class="math inline">\(b\)</span> inclusive, <span class="math inline">\(a \leq x \leq b\)</span></p>
<p><span class="math inline">\(\left \lVert x \right \rVert\)</span> — The length of vector <span class="math inline">\(x\)</span></p>
<p><span class="math inline">\(T_c(t)\)</span> — Thrust force acting on rocket at time t</p>
<p><span class="math inline">\(m(t)\)</span> — Mass of rocket at time t</p>
<p><span class="math inline">\(r(t)\)</span> — Position vector of spacecraft at time t relative to surface</p>
<p><span class="math inline">\(\dot{r}(t)\)</span> — Velocity vector of spacecraft at time t relative to surface</p>
<p><span class="math inline">\(\ddot{r}(t)\)</span> — Acceleration vector spacecraft at time t relative to surface</p>
<p><span class="math inline">\(\forall\)</span> — for all</p>
</div>
<div id="problem-formulation" class="section level1">
<h1>Problem Formulation</h1>
<p>The paper assumes that:</p>
<ul>
<li>There is a uniform gravity field as the landing mission starts at a low altitude relative to planet’s radius.</li>
<li>Other forces such as aerodynamic forces are ignored and treated as disturbances</li>
<li>The lander is a point mass, so we ignore rotational forces</li>
</ul>
<p>The dynamics of the lander are expressed by:</p>
<p><span class="math display">\[\begin{align*}
  \ddot{r}(t) &amp;= g + \frac{T_c(t)}{m(t)} \\
  \dot{m}(t) &amp;= - \alpha ||T_c(t)||
\end{align*}\]</span></p>
<p>The only two forces acting on the rocket are weight and the net thrust force. Additionally, the mass decreases proportionally to the magnitude of the thrust vector.</p>
<p>The initial conditions are <span class="math inline">\(m(0) = m_{wet}\)</span>, <span class="math inline">\(r(0) = r_0\)</span>, <span class="math inline">\(\dot{r}(0) = \dot{r}_0\)</span>.</p>
<p>The magnitude of the net thrust vector is constrained by <span class="math inline">\(0 &lt; \rho_{1} \leq ||T_c(t)|| \leq \rho_{2} \forall t \in [0, t_f]\)</span>. The final position and velocity are set to 0, <span class="math inline">\(r(t_{f}) =\dot{r}(t_{f}) = 0\)</span>. Additionally the lander starts off above the surface and never goes below it, <span class="math inline">\(r_{1}(0) &gt; 0\)</span>, <span class="math inline">\(r_{1}(t) \geq 0 \ \ \text{for all} \ t \in [0, t_{f}]\)</span>.
Any additional constraints are assumed to have the general form of <span class="math inline">\(||S_j x(t) - v_j|| + c^T_j x(t) + a_j \leq 0,\ j = 1, \ldots, n_s\)</span> for all <span class="math inline">\(t \in [0, t_f]\)</span> where <span class="math inline">\(x = [r, \dot{r}]^T\)</span>. The paper imposes two inequalities in this form: a bound on the velocity <span class="math inline">\(|| \dot{r}(t) \leq \hat{V}|| \text{ for } t \in [0, t_f]\)</span> and a “glide slope” constraint <span class="math inline">\(\displaystyle \arctan \left( \frac{\sqrt{r_2(t)^2 + r_3(t)^2}}{r_1(t)} \right) \leq \tilde{\theta}_\text{alt} \leq \frac{\pi}{2}\)</span>.</p>
<div id="problem-1" class="section level3">
<h3>Problem 1</h3>
<p>Given the dynamics and constraints outlined above, the trajectory which maximises the final mass of the rocket (equivalent to minimising the loss in mass) is descirbed as follows:</p>
<p><span class="math display">\[\begin{align*}
  \max_{t_f, T_c(\bullet)} m(t_f) &amp;= \min_{t_f, T_c(\bullet)} \int_{0}^{t_{f}} dt \\
  \text{subject to } \ddot{r}(t) &amp;= g + \frac{T_c(t)}{m(t)}, \hspace{1cm} \dot{m}(t) = - \alpha ||T_c(t)|| \\
  0 &lt; \rho_{1} &amp;\leq ||T_c(t)|| \leq \rho_{2}, \hspace{0.6cm} r_1(t) \geq 0 \\
  ||S_j x(t) - v_j|| &amp;+ c^T_j x(t) + a_j \leq 0, \hspace{0.5cm} j = 1, \ldots, n_s \\
  m(0) = m_{wet}&amp;, \hspace{0.8cm} r(0) = r_0, \hspace{0.9cm} \dot{r}(0) = \dot{r}_0 \\
  &amp;\hspace{0.15cm} r(t_f) = \dot{r}(t_f) = 0
\end{align*}\]</span></p>
<p><span class="math inline">\(0 &lt; \rho_{1} \leq \left \lVert T_c(t) \right \rVert \leq \rho_{2} \forall t \in [0, t_f]\)</span> is a nonconvex constraint on the control input and so we need to deal with it in order to obtain a convex optimisation problem.</p>
</div>
</div>
<div id="convexification-of-the-control-magnitude-constraint" class="section level1">
<h1>Convexification of the Control Magnitude Constraint</h1>
<p>In this section the paper formulates a modified version of <a href="#problem-1">Problem 1</a> and shows that an optimal solution of the modified problem is optimal for <a href="#problem-1">Problem 1</a> and that it exists.</p>
<div id="problem-2" class="section level3">
<h3>Problem 2</h3>
<p>The modified version of <a href="#problem-1">Problem 1</a> is as follows:</p>
<p><span class="math display">\[\begin{align*}
  \min_{t_f, T_c(\bullet), \Gamma(\bullet)} \int_{0}^{t_f} \Gamma(t) \,&amp;dt \hspace{1cm} \text{subject to } \dot{m}(t) = - \alpha \Gamma (t) \\
  &amp;||T_c(t)|| \leq \Gamma \\
  0 &amp;&lt; \rho_1 \leq \Gamma(t) \leq \rho_2 \\
  \ddot{r}(t) &amp;= g + \frac{T_c(t)}{m(t)}, \hspace{1cm} r_1(t) \geq 0 \\
  ||S_j x(t) - v_j|| &amp;+ c^T_j x(t) + a_j \leq 0, \hspace{1cm} j = 1, \ldots, n_s \\
  m(0) &amp;= m_{wet}, \hspace{0.6cm} r(0) = r_0, \hspace{0.5cm} \dot{r}(0) = \dot{r}_0 \\
  &amp;\hspace{0.15cm} r(t_f) = \dot{r}(t_f) = 0 
\end{align*}\]</span></p>
<p><a href="#problem-2">Problem 2</a> has introduced a slack variable <span class="math inline">\(\Gamma\)</span> which replaces $T_c(t) $ and introduces a new constraint <span class="math inline">\(\left \lVert T_c(t) \right \rVert \leq \Gamma(t)\)</span>.
A solution to <a href="#problem-1">Problem 1</a> is clearly a feasible solution of <a href="#problem-2">Problem 2</a> as we can simply set <span class="math inline">\(T_c(t) = \Gamma(t)\)</span>, however the converse needs to be proved and so below it wil be shown that an optimal solution of <a href="#problem-2">Problem 2</a> is also an optimal solution of <a href="#problem-1">Problem 1</a>, which allows us to solve <a href="#problem-1">Problem 1</a> by solving the convex <a href="#problem-2">Problem 2</a>.</p>
<div class="lemma">
<p><span id="lem:unlabeled-div-1" class="lemma"><strong>Lemma 1  </strong></span>Consider a solution of <a href="#problem-2">Problem 2</a> given by <span class="math inline">\([t_f^*, T_c^*(\bullet), \Gamma^*(\bullet)]\)</span>. Then, <span class="math inline">\([t_f^*, T_c^* (\bullet)]\)</span> is also a solution of <a href="#problem-1">Problem 1</a> and <span class="math inline">\(||T_c^*(t)|| = \rho_1\)</span> or <span class="math inline">\(||T_c^*(t)|| = \rho_2 \text{ for } t \in [0, t_f^*]\)</span>.</p>
</div>
<div class="proof">
<p><span id="unlabeled-div-2" class="proof"><em>Proof</em>. </span>Let <span class="math inline">\(y = [x^T,\ m]^T\)</span> and <span class="math inline">\(x_1 = r,\ x_2 = \dot{r}\)</span>, then <span class="math inline">\(\dot{y} = [x_2,\ g + T_c / m,\ - \alpha \Gamma]^T\)</span>. The Hamiltonian for <a href="#problem-2">Problem 2</a> is <span class="math inline">\(H(x, m, T_c, \Gamma, \lambda_0, \lambda) = \lambda_0 ( \Gamma ) + \lambda^T \dot{y}\)</span> <span class="math inline">\(= \lambda_0 \Gamma + \lambda^{T} x_2 + \frac{\lambda^T_2 T_c}{m} + \lambda^T_2 g - \alpha \lambda_3 \Gamma\)</span> with <span class="math inline">\(\lambda_0 \leq 0\)</span>. Let <span class="math inline">\(v = [T_c^T,\ \Gamma]^T\)</span>, then there exist a <span class="math inline">\(\lambda_0 \leq 0\)</span> and an absolutely continouous vector function <span class="math inline">\(\lambda\)</span> such that</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\([\lambda_0,\ \lambda^T]^T \neq 0\)</span> for all <span class="math inline">\(t \in [0,\ t^*_f]\)</span>
<span class="math display">\[\begin{align*}
  \dot{\lambda} = \frac{\partial H}{\partial y} \left( y^*,\ v^*,\ \lambda_0,\ \lambda \right)
\end{align*}\]</span></p></li>
<li><p><span class="math display">\[\begin{align*}
  H(y^*(t),\ v^*(t), \lambda_0, \lambda) \geq H(y^*(t),\ v, \lambda_0, \lambda) \hspace{0.5cm} \forall v \in \Psi \hspace{0.5cm} \forall t \in [0, t^*_f]
\end{align*}\]</span></p></li>
<li><p>The transversality condition: <span class="math inline">\(\left[ H(\psi(0)),\ -\lambda(0)^T,\ -H(\psi(t^*_f)),\ \lambda(t_f^*)^T \right]^T\)</span> must be orthorgonal to <span class="math inline">\(\left[ 0,\ y^*(0)^T,\ t_f^*,\ y^*(t_f^*)^T \right]\)</span></p></li>
</ol>
</div>
<p>We can see <span class="math inline">\(\frac{\partial H}{\partial y} \left( y^*,\ v^*,\ \lambda_0,\ \lambda \right) = -\begin{bmatrix} 0 \\ \lambda_1 \\ \lambda_2^T T^*_c * -\frac{1}{m^2} \end{bmatrix}\)</span></p>
</div>
</div>
